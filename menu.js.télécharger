function getCookieByName(e){const t=e+"=";e=decodeURIComponent(document.cookie).split("; ");let o="";return e.forEach(e=>{0===e.indexOf(t)&&(o=e.substring(t.length))}),o}function setCookie(e,t,o){o=new Date(Date.now()+1e3*o).toUTCString();let a="";window.location.href.includes("localhost")||(a="domain=.besoccer.com;"),document.cookie=e+"="+t+"; expires="+o+"; "+a+"path=/"}async function doFetch(e,t){return fetch(e,{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(t)})}function changeViewUser(){document.querySelectorAll('[data-loginStatus="notLogged"]').forEach(e=>{e.classList.add("hidden")}),document.querySelectorAll('[data-loginStatus="logged"]').forEach(e=>{let t=getCookieByName("userAvatar");t&&document.querySelectorAll(".userAvatar").forEach(e=>{e.src=t});var o=getCookieByName("userName"),o=(o&&(document.getElementById("userName").innerText=o),getCookieByName("userEmail"));o&&(document.getElementById("userEmail").innerText=o),e.classList.remove("hidden")})}function checkLastTime(){var e=getCookieByName("lastTime"),t=Date.now();return!e||1e3*e<t}function showFavouritesButtons(){var e=document.getElementsByClassName("favouritesPopupBtn"),e=(e&&Array.from(e).forEach(e=>{e.classList.remove("hidden")}),document.getElementsByClassName("favoriteButton"));if(e){const t=document.querySelector(".starFavorites svg.empty.hidden");Array.from(e).forEach(e=>{t&&(e.checked=!0)})}}function showStars(){var e=document.querySelector(".starFavorites[data-favoritekey]");e&&updateSvgFavouritesVisibility(checkIfItemExists(e.getAttribute("data-favoritekey"),e.getAttribute("data-favoriteExtra")??""))}function checkIfItemExists(t,e){const o=getCookieByName("userFavorites").split(",");return e?(e=e.split(","),o.includes("+"+t+"_"+e[0])||o.includes("+"+t+"_all")||1<e.length&&e.slice(1).every(e=>o.includes("+"+t+"_"+e))):o.includes("+"+t)}function updateSvgFavouritesVisibility(t){Array.from(document.getElementsByClassName("svg-favourites")).forEach(e=>{e.classList.contains("notFavorite")||(e.classList.add("hidden"),e.classList.contains("full")&&t&&e.classList.remove("hidden"),e.classList.contains("empty")&&!t&&e.classList.remove("hidden"))})}function updateCookiesFromItem(e,t,o){let a=getCookieByName("userFavorites"),s=(a=""===a?[]:a.split(","),{add:[],delete:[]});var r;return o[0]?"add"===e?o[1]?(r=o[1].split(",")).every(e=>a.includes("+"+t+"_"+e))?(r.forEach(e=>{s.delete.push(t+"_"+e)}),s.add.push(t+"_all")):s.add.push(t+"_"+o[0]):("all"===o[0]&&a.forEach(e=>{e.includes("+"+t+"_")&&s.delete.push(t)}),s.add.push(t+"_"+o[0])):a.includes("+"+t+"_"+o[0])?s.delete.push(t+"_"+o[0]):a.includes("+"+t+"_all")&&(s.delete.push(t+"_all"),o[1])&&o[0]!==o[1]&&o[1].split(",").forEach(e=>{s.add.push(t+"_"+e)}):s[e].push(t),0<s.add.length&&s.add.forEach(e=>{-1!==a.indexOf("-"+e)?a[a.indexOf("-"+e)]="+"+e:a.push("+"+e)}),0<s.delete.length&&s.delete.forEach(e=>{var t=a.indexOf("+"+e);-1!==t?a[t]="-"+e:a.push("-"+e)}),a.join(",")}function updateFavorites(e,t,o){var a,s;getCookieByName("userHash")&&(a=e.value,s=e.getAttribute("data-extra")?.split("_"),fetchCookies(updateCookiesFromItem(e=e.checked?"add":"delete",a,s),t,o,e))}function fetchCookies(o,e,t,a,s=0){"add"===a?Alert.success(e,t,{displayDuration:2e3}):"delete"===a&&Alert.warning(e,t,{displayDuration:2e3}),doFetch("/ajax/updateFavorites?random="+Math.random(),{favorites:o}).then(e=>{if(e.ok)return e.json();throw new Error("Error fetching items")}).then(e=>{let t=o.split(",").filter(e=>"-"!==e.substring(0,1)).join(",");setCookie("userFavorites",t=e.response&&200===e.response.status?e?.favorites??"":t,1296e3),showStars(),s&&(toggleTrashCan(),renewFavoritesView(t))})}(()=>{var e=getCookieByName("userHash");e&&(changeViewUser(),document.addEventListener("DOMContentLoaded",function(){showStars(),showFavouritesButtons()}),checkLastTime())&&doFetch("/ajax/userLogin",{hash:getCookieByName("userName")+"_"+e}).then(e=>{if(e.ok)return e.json();throw new Error("Error fetching items")}).then(e=>{e.banned&&(window.location.href=e.banned),e.user&&e.favorites&&setCookie("userFavorites",e.favorites)})})();let temporalCookies={};function toggleEditFavorites(){temporalCookies={},Array.from(document.getElementsByClassName("delete-favourites")).forEach(e=>{e.classList.toggle("hidden")}),Array.from(document.getElementsByClassName("trash-icon")).forEach(e=>{e.classList.remove("active")}),document.getElementById("applyDelete").classList.toggle("hidden")}function deleteFavorite(e,t,o=""){(o=o?.split("_"))[1]&&(o[1]=o[1].split(",").filter(e=>e!==o[0]).join(","));var a=t+"-"+o?.join("_");e.classList.toggle("active"),e.classList.contains("active")?temporalCookies[a]={type:"delete",uniqueId:t,extra:o}:delete temporalCookies[a]}function applyDelete(e,t){if(toggleTrashCan(),0<Object.keys(temporalCookies).length)for(var o in temporalCookies)setCookie("userFavorites",updateCookiesFromItem(temporalCookies[o].type,temporalCookies[o].uniqueId,temporalCookies[o].extra),1296e3);fetchCookies(getCookieByName("userFavorites"),e,t,"delete",1)}function toggleTrashCan(){document.querySelectorAll(".trash-icon").forEach(e=>{e.classList.toggle("disabled-click")})}let mapFavoritesItems=["Competitions","Teams","Players","Matches"];function renewFavoritesView(a){a=a.split(",").map(e=>e.substring(1)),mapFavoritesItems.forEach(e=>{var t,o=document.getElementById("favorites"+e);void 0!==o&&0<o.querySelector("[data-counter]").innerText&&(t=destroyElement(o.querySelector("[data-rowsItems]"),a),o.querySelector("[data-counter]").innerText=t,"Players"===e&&0===t&&o.querySelector("[data-rowsItems]").remove(),0===t)&&o.querySelector(".hidden").classList.remove("hidden")})}function destroyElement(e,o){if(0===o.length)return 0;e=e.querySelectorAll("[data-referenceItem]");let a=e.length;return e.forEach(e=>{var t=e.getAttribute("data-referenceItem");-1===o.indexOf(t)&&o.indexOf(t.replace("/_[0-9]{1,}/","_all"))&&(a--,e.remove())}),a}